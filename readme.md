**主要功能:**

1.  **批量图片尺寸调整:**
    *   **等比缩放:**  用户可以通过滑动条选择一个缩放比例（0.1 倍到 2.0 倍），程序会按照这个比例等比例地缩放所有选定的图片。
    *   **指定尺寸:** 用户可以手动输入目标图片的宽度和高度（以像素为单位），程序会将所有选定的图片调整到指定的尺寸。
2.  **批量图片格式转换:**
    *   用户可以通过下拉列表选择输出图片的格式，支持的格式包括 JPEG、PNG、GIF、BMP 和 TIFF。
3.  **文件夹拖放:**
    *   用户可以直接将包含图片的文件夹拖放到程序的输入框中，程序会自动识别文件夹路径。
4.  **进度条显示:**
    *   程序在处理图片时，会显示一个进度条，实时反映处理进度。
5.  **多线程处理:**
    *   程序使用多线程来处理图片，可以充分利用多核 CPU，加快处理速度。
    *   线程数量默认为 4，可以在代码中修改 `ThreadPoolExecutor` 的 `max_workers` 参数来调整。
6.  **日志记录:**
    *   程序会将处理过程中的信息（包括处理的文件、处理结果、错误信息等）记录到日志文件中（`image_processor.log`），方便用户查看和排查问题。
    *   日志文件采用覆盖模式,每次运行都会生成新的日志.
7.  **错误处理:**
    *   程序对可能出现的错误进行了处理，包括：
        *   未选择输入/输出文件夹
        *   输入/输出文件夹不存在
        *   输入文件夹中没有找到支持的图像文件
        *   打开图像失败
        *   调整图像尺寸失败
        *   保存图像失败
        *   其他未知错误
    *   当发生错误时，程序会弹出错误提示框，并将详细的错误信息记录到日志文件中。

**技术细节:**

*   **GUI 框架:** Tkinter (结合 tkinterdnd2 实现拖放)
*   **图像处理库:** Pillow (PIL)
*   **多线程:** `concurrent.futures.ThreadPoolExecutor`
*   **日志记录:** `logging` 模块
*   **线程间通信:** `queue.Queue`
*   **GUI 更新:** 使用 `self.master.after()` 定时器和队列，确保在主线程中更新 GUI。

**使用说明:**

1.  **安装依赖:**
    ```bash
    pip install pillow tkinterdnd2
    ```
2.  **运行程序:**
    ```bash
    python your_script_name.py
    ```
3.  **选择输入文件夹:**
    *   点击“选择”按钮，选择包含图片的文件夹。
    *   或者直接将文件夹拖放到输入框中。
4.  **选择输出文件夹:**
    *   点击“选择”按钮，选择用于保存处理后图片的文件夹。
5.  **设置缩放选项:**
    *   选择“等比缩放”，并通过滑动条调整缩放比例。
    *   或者选择“指定尺寸”，并输入目标宽度和高度。
6.  **选择输出格式:**
    *   从下拉列表中选择输出图片的格式。
7.  **开始处理:**
    *   点击“开始处理”按钮。
8.  **查看进度:**
    *   处理过程中，进度条会实时显示进度。
9.  **查看结果:**
    *   处理完成后，程序会弹出提示框。
    *   处理后的图片会保存在输出文件夹中。
10. **查看日志:**
    *   处理过程中的信息和错误会记录在 `image_processor.log` 文件中。

**代码结构:**

*   `ImageBatchProcessor` 类：
    *   `__init__`: 初始化 GUI、变量、日志记录器、线程池等。
    *   `setup_logger`: 配置日志记录器。
    *   `create_widgets`: 创建 GUI 组件。
    *   `update_scale_label`: 更新显示缩放比例的标签。
    *   `select_input_dir`: 选择输入文件夹。
    *   `select_output_dir`: 选择输出文件夹。
    *   `handle_drop`: 处理拖放事件。
    *   `process_single_image`: 处理单个图像（在子线程中运行）。
    *   `process_images`: 启动多线程处理。
    *   `process_gui_queue`: 处理 GUI 队列中的消息（在主线程中运行）。

希望这个总结对您有帮助！
